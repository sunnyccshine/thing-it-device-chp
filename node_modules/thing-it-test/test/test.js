// Load [thing-it] Test Driver

var testDriver = require("../lib/thing-it-test").createTestDriver({
    logLevel: "info"
});

// Register Device, Actor and Sensor Plugins

testDriver.registerDevicePlugin(__dirname + "/dummyDevice");
testDriver.registerUnitPlugin(__dirname + "/dummyActor");
testDriver.registerUnitPlugin(__dirname + "/dummySensor");

// Create and initialize Devices, Actors and Sensors

var testConfiguration = require("./dummyConfiguration.js");

// Initialize Test Driver and run the test

testDriver.start({
    configuration: testConfiguration,
    heartbeat: 10,
    simulation: true
}).then(function () {
    setTimeout(function () {
        testDriver.dummyDevice1.dummyActor1.on();
        testDriver.dummyDevice1.dummyActor1.off();
        testDriver.dummyDevice1.dummyActor1.toggle();

        testDriver.stop().then(function () {
        }).fail(function (error) {
            testDriver.logError("Could not stop Device: " + error);
        });
    }, 20000);
}).fail(function (error) {
    testDriver.logError("Could not start Device: " + error);
});

